<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:WurmTools.Modules.Items.ViewModels"
             x:Class="WurmTools.Modules.Items.Views.ItemBrowserView"
             x:DataType="vm:ItemBrowserViewModel">

    <Grid RowDefinitions="Auto,*" Margin="16,12,16,8">

        <!-- Header: search + item count -->
        <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,10">
            <TextBox Grid.Column="0"
                     Classes="search"
                     Watermark="Search items by name, category, or material..."
                     Text="{Binding SearchText, Mode=TwoWay}" />
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        Margin="12,0,0,0"
                        Spacing="6">
                <Border Classes="badge badgeCategory">
                    <TextBlock Text="{Binding TotalCount, StringFormat='{}{0} items'}"
                               FontSize="12"
                               Foreground="#8899aa" />
                </Border>
            </StackPanel>
        </Grid>

        <!-- Main split: list + detail -->
        <Grid Grid.Row="1" ColumnDefinitions="320,*">

            <!-- Item list panel -->
            <ListBox Grid.Column="0"
                     Classes="itemList"
                     ItemsSource="{Binding Items}"
                     SelectedItem="{Binding SelectedItem}"
                     Margin="0,0,8,0"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid ColumnDefinitions="Auto,*" Margin="2">
                            <!-- Color accent bar based on category feel -->
                            <Border Grid.Column="0"
                                    Width="3"
                                    CornerRadius="2"
                                    Background="#e94560"
                                    Margin="0,0,10,0" />
                            <StackPanel Grid.Column="1" Spacing="2">
                                <TextBlock Text="{Binding Name}"
                                           FontWeight="SemiBold"
                                           FontSize="14"
                                           Foreground="#e0e0e0" />
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <Border Classes="badge badgeCategory">
                                        <TextBlock Text="{Binding Category}"
                                                   FontSize="11"
                                                   Foreground="#7799bb" />
                                    </Border>
                                    <Border Classes="badge badgeMaterial">
                                        <TextBlock Text="{Binding Material}"
                                                   FontSize="11"
                                                   Foreground="#aa77cc" />
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <!-- Detail panel -->
            <Border Grid.Column="1"
                    Classes="detailPanel"
                    Margin="8,0,0,0"
                    IsVisible="{Binding SelectedItem, Converter={x:Static ObjectConverters.IsNotNull}}">
                <ScrollViewer>
                    <StackPanel DataContext="{Binding SelectedItem}" Spacing="4">

                        <!-- Item title -->
                        <TextBlock Text="{Binding Name}"
                                   FontSize="26"
                                   FontWeight="Bold"
                                   Foreground="#ffffff"
                                   Margin="0,0,0,4" />

                        <!-- Description -->
                        <TextBlock Text="{Binding Description}"
                                   TextWrapping="Wrap"
                                   FontSize="14"
                                   Foreground="#8899aa"
                                   Margin="0,0,0,8" />

                        <!-- Tag row -->
                        <WrapPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <Border Classes="badge badgeCategory" Margin="0,0,6,6">
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock Text="Category:" FontSize="11" Foreground="#556" />
                                    <TextBlock Text="{Binding Category}" FontSize="11" Foreground="#7799bb" FontWeight="SemiBold" />
                                </StackPanel>
                            </Border>
                            <Border Classes="badge badgeMaterial" Margin="0,0,6,6">
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock Text="Material:" FontSize="11" Foreground="#556" />
                                    <TextBlock Text="{Binding Material}" FontSize="11" Foreground="#aa77cc" FontWeight="SemiBold" />
                                </StackPanel>
                            </Border>
                            <Border Classes="badge badgeSkill" Margin="0,0,6,6">
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock Text="Skill:" FontSize="11" Foreground="#556" />
                                    <TextBlock Text="{Binding Skill}" FontSize="11" Foreground="#77cc99" FontWeight="SemiBold" />
                                </StackPanel>
                            </Border>
                            <Border Classes="badge badgeContainer"
                                    Margin="0,0,6,6"
                                    IsVisible="{Binding IsContainer}">
                                <TextBlock Text="Container" FontSize="11" Foreground="#ccaa77" FontWeight="SemiBold" />
                            </Border>
                        </WrapPanel>

                        <Separator />

                        <!-- Stats section -->
                        <TextBlock Classes="sectionHeader" Text="STATS" />

                        <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto" Margin="0,0,0,4">
                            <!-- Weight -->
                            <StackPanel Grid.Column="0" Spacing="2">
                                <TextBlock Classes="propLabel" Text="WEIGHT" />
                                <TextBlock Classes="propValue" Text="{Binding Weight, StringFormat='{}{0:F1} kg'}" />
                            </StackPanel>
                            <!-- Difficulty -->
                            <StackPanel Grid.Column="1" Spacing="2">
                                <TextBlock Classes="propLabel" Text="DIFFICULTY" />
                                <TextBlock Classes="propValue" Text="{Binding Difficulty, StringFormat='{}{0:F0}'}" />
                            </StackPanel>
                            <!-- Improvable -->
                            <StackPanel Grid.Column="2" Spacing="2">
                                <TextBlock Classes="propLabel" Text="IMPROVABLE" />
                                <TextBlock Classes="propValue" Text="{Binding IsImproved}" />
                            </StackPanel>
                        </Grid>

                        <Separator />

                        <!-- Notes section -->
                        <TextBlock Classes="sectionHeader" Text="NOTES" />
                        <TextBlock Text="{Binding Notes}"
                                   TextWrapping="Wrap"
                                   FontSize="13"
                                   Foreground="#aabbcc"
                                   LineHeight="20" />

                        <!-- Wiki link -->
                        <TextBlock Classes="sectionHeader" Text="REFERENCE" Margin="0,16,0,6" />
                        <TextBlock Text="{Binding WikiUrl}"
                                   FontSize="12"
                                   Foreground="#e94560"
                                   TextDecorations="Underline"
                                   Cursor="Hand" />

                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Empty state placeholder -->
            <Border Grid.Column="1"
                    Classes="detailPanel"
                    Margin="8,0,0,0"
                    IsVisible="{Binding SelectedItem, Converter={x:Static ObjectConverters.IsNull}}">
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="8">
                    <Border Width="48" Height="48"
                            CornerRadius="24"
                            Background="#0f3460"
                            HorizontalAlignment="Center">
                        <TextBlock Text="?"
                                   FontSize="24"
                                   FontWeight="Bold"
                                   Foreground="#e94560"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                    </Border>
                    <TextBlock Text="Select an item"
                               FontSize="16"
                               Foreground="#556"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Choose an item from the list to view its details"
                               FontSize="12"
                               Foreground="#334"
                               HorizontalAlignment="Center" />
                </StackPanel>
            </Border>

        </Grid>
    </Grid>
</UserControl>
